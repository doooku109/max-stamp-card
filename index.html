<!DOCTYPE html>
<html>
<head>
    <title>スタンプカード</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; }
        #qr-container {
            width: 256px;
            height: 256px;
            margin: 20px auto;
            border: 1px dashed #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #stamps { font-size: 3em; font-weight: bold; }
    </style>
</head>
<body>
    <h1>あなたのスタンプカード</h1>
    <div id="qr-container">
        <canvas id="qr"></canvas>
    </div>
    <p>現在のスタンプ数</p>
    <p id="stamps">0 (テスト中)</p>

    <script>
        // ▼▼▼ ここからが修正箇所 ▼▼▼
        // ページの読み込みが完了してから、中の処理を実行する
        document.addEventListener('DOMContentLoaded', function() {

            // URLからIDを読み取らず、直接書き込む
            const userId = 'test-for-iphone';

            // QRコードの描画を試す
            try {
                new QRious({
                    element: document.getElementById('qr'),
                    value: userId,
                    size: 256
                });
            } catch (e) {
                // エラー内容を画面に表示する
                const qrContainer = document.getElementById('qr-container');
                qrContainer.innerHTML = 'QRコード生成エラー:<br>' + e.message;
            }
        });
        // ▲▲▲ ここまでが修正箇所 ▲▲▲
    </script>
</body>
</html>
